<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Annuaire Mods & Plugins - CraftKit</title>
    <!-- Chargement du CDN de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        html { font-family: 'Inter', sans-serif; }
        .tab-active {
            @apply border-yellow-500 text-yellow-500 font-bold bg-gray-700/50;
        }
        .tab-inactive {
            @apply border-transparent text-gray-400 hover:text-white hover:border-gray-600;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 antialiased min-h-screen">

    <!-- Navbar -->
    <header class="bg-gray-800 shadow-lg sticky top-0 z-10">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center space-x-2">
                <svg class="w-8 h-8 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 100 4m-3 12h2m-6-10h4m-2 4h4m-2 4h2M5 16h2m10 0h2m-6 4a2 2 0 100 4m-3-12h2m-6 0h4m-2 4h4m-2 4h2"></path></svg>
                <span class="text-2xl font-extrabold text-white">Craft<span class="text-yellow-400">Kit</span></span>
            </a>
            <div class="space-x-4">
                <a href="admin_panel.html" class="text-gray-400 hover:text-white transition duration-300 hidden sm:inline">Admin</a>
                <a href="login.html" class="px-4 py-2 bg-yellow-500 text-gray-900 rounded-lg font-semibold hover:bg-yellow-400 transition duration-300">Connexion</a>
            </div>
        </nav>
    </header>

    <!-- Contenu Principal -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-10">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl font-extrabold mb-4 text-white">Annuaire des Ressources</h1>
            <p class="text-gray-400 mb-8">Trouvez votre mod ou plugin. Les liens de t√©l√©chargement renvoient directement √† la page officielle Modrinth.</p>
            
            <!-- Message d'information sur les donn√©es (Mise √† jour de l'explication CORS) -->
            <div id="api-notice" class="bg-red-900/50 border border-red-600 p-3 rounded-lg text-sm text-red-300 mb-6 flex items-center space-x-3">
                <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                <span>Attention: Le chargement direct des donn√©es via l'API Modrinth est bloqu√© par la politique CORS. Les donn√©es sont **simul√©es** pour l'affichage, mais les boutons "T√©l√©charger" vous m√®nent √† la page Modrinth r√©elle pour un t√©l√©chargement s√©curis√©.</span>
            </div>

            <!-- Syst√®me d'Onglets -->
            <div class="mb-8 border-b border-gray-700">
                <div class="-mb-px flex space-x-4" role="tablist">
                    <button id="tab-mods" onclick="setActiveTab('mod')" role="tab"
                            class="py-3 px-6 border-b-2 text-lg transition duration-200 tab-active">
                        Mods
                    </button>
                    <button id="tab-plugins" onclick="setActiveTab('plugin')" role="tab"
                            class="py-3 px-6 border-b-2 text-lg transition duration-200 tab-inactive">
                        Plugins
                    </button>
                </div>
            </div>

            <!-- Barre de Recherche et Filtres -->
            <div class="mb-8 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
                <input type="text" id="search-input" onkeyup="loadResources(activeTab)" placeholder="Rechercher un Mod..."
                       class="flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-yellow-500 focus:border-yellow-500 transition duration-150">
                
                <select id="version-filter" onchange="loadResources(activeTab)"
                        class="px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-yellow-500 focus:border-yellow-500 transition duration-150 w-full md:w-auto">
                    <option value="">Toutes les Versions</option>
                    <option value="1.20">1.20+</option>
                    <option value="1.19">1.19.x</option>
                    <option value="1.16">1.16.x</option>
                </select>
            </div>
            
            <!-- Indicateur de Chargement (Visible lors de la simulation de chargement) -->
            <div id="loading-indicator" class="text-center p-12 hidden">
                <svg class="animate-spin h-8 w-8 text-yellow-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="mt-3 text-white">Simulation de la recherche Modrinth...</p>
            </div>


            <!-- Conteneur des Cartes de Ressources -->
            <div id="resources-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Les cartes de ressources seront ins√©r√©es ici par JavaScript -->
            </div>
            
            <!-- Message de r√©sultat vide -->
            <div id="no-results" class="hidden text-center p-12 bg-gray-800 rounded-xl mt-8 border border-gray-700">
                <svg class="w-12 h-12 mx-auto text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                <p class="text-xl font-semibold mt-4 text-white">Aucun r√©sultat trouv√©.</p>
                <p class="text-gray-400">Essayez un autre terme de recherche ou changez les filtres.</p>
            </div>

        </div>
    </main>

    <!-- JavaScript pour la gestion des donn√©es, des onglets et du rendu -->
    <script>
        // Active project type (mod or plugin)
        let activeTab = 'mod';

        // --- DONN√âES MODRINTH SIMUL√âES ---
        // Mimics essential fields from the Modrinth API response
        const simulatedData = {
            mod: [
                { slug: 'fabric-api', title: "Fabric API", description: "L'API principale pour tous les mods Fabric. N√©cessaire pour la plupart.", project_type: "mod", downloads: 55000000, version: "1.20.1", icon: "üíé" },
                { slug: 'sodium', title: "Sodium", description: "Optimisation de rendu massive pour am√©liorer les performances FPS.", project_type: "mod", downloads: 30000000, version: "1.20.1", icon: "üöÄ" },
                { slug: 'iris', title: "Iris Shaders", description: "Ajoute la prise en charge des shaders packs Fabric/Forge.", project_type: "mod", downloads: 15000000, version: "1.20.1", icon: "‚ú®" },
                { slug: 'advent-of-ascension', title: "Advent of Ascension", description: "Un √©norme mod d'aventure ajoutant des dimensions et des boss.", project_type: "mod", downloads: 400000, version: "1.16.5", icon: "‚öîÔ∏è" },
                { slug: 'chiseled-bits', title: "Chiseled Bits", description: "Mod√©lisez des blocs de mani√®re d√©taill√©e au niveau des pixels.", project_type: "mod", downloads: 7000000, version: "1.19.4", icon: "‚õèÔ∏è" },
            ],
            plugin: [
                { slug: 'essentialsx', title: "EssentialsX", description: "Le plugin de base indispensable pour les commandes serveur (warps, homes).", project_type: "plugin", downloads: 90000000, version: "1.20.1", icon: "üîß" },
                { slug: 'worldguard', title: "WorldGuard", description: "Prot√©gez votre monde contre le grief et g√©rez les r√©gions.", project_type: "plugin", downloads: 65000000, version: "1.20.1", icon: "üõ°Ô∏è" },
                { slug: 'luckperms', title: "LuckPerms", description: "Syst√®me de permissions ultra-rapide et flexible.", project_type: "plugin", downloads: 40000000, version: "1.20.1", icon: "üîë" },
                { slug: 'dynmap', title: "Dynmap", description: "G√©n√®re une carte web en temps r√©el de votre monde Minecraft.", project_type: "plugin", downloads: 12000000, version: "1.19.4", icon: "üó∫Ô∏è" },
                { slug: 'skript', title: "Skript", description: "Permet d'√©crire des scripts sans coder de plugin Java.", project_type: "plugin", downloads: 20000000, version: "1.16.5", icon: "üìú" },
            ]
        };

        // Fonction pour g√©n√©rer l'URL de la page Modrinth √† partir du slug
        function getModrinthUrl(slug) {
            return `https://modrinth.com/${activeTab}/${slug}`;
        }

        // Fonction pour changer l'onglet actif et recharger les ressources
        function setActiveTab(tabName) {
            // tabName est soit 'mod' soit 'plugin'
            activeTab = tabName;
            
            // Mise √† jour du style des boutons
            document.getElementById('tab-mods').className = 'py-3 px-6 border-b-2 text-lg transition duration-200 ' + (tabName === 'mod' ? 'tab-active' : 'tab-inactive');
            document.getElementById('tab-plugins').className = 'py-3 px-6 border-b-2 text-lg transition duration-200 ' + (tabName === 'plugin' ? 'tab-active' : 'tab-inactive');
            
            // Mise √† jour du placeholder de recherche
            const placeholder = tabName === 'mod' ? 'Rechercher un Mod...' : 'Rechercher un Plugin...';
            document.getElementById('search-input').placeholder = placeholder;
            
            loadResources(activeTab);
        }

        // Simule la r√©cup√©ration de donn√©es et applique les filtres
        async function fetchSimulatedData(query, projectType, version) {
            const loading = document.getElementById('loading-indicator');
            loading.classList.remove('hidden');

            // Simuler un d√©lai r√©seau
            await new Promise(resolve => setTimeout(resolve, 800)); 

            let results = simulatedData[projectType];

            // 1. Filtrage par recherche (titre ou description)
            if (query) {
                const searchLower = query.toLowerCase();
                results = results.filter(item => 
                    item.title.toLowerCase().includes(searchLower) || 
                    item.description.toLowerCase().includes(searchLower)
                );
            }

            // 2. Filtrage par version (v√©rification simple des 4 premiers caract√®res)
            if (version) {
                results = results.filter(item => item.version.startsWith(version));
            }
            
            loading.classList.add('hidden');
            return results;
        }

        // Fonction pour cr√©er le HTML d'une carte de ressource
        function createResourceCard(resource) {
            const card = document.createElement('div');
            card.className = 'bg-gray-800 p-6 rounded-xl shadow-xl border border-gray-700 hover:border-yellow-500 transition duration-300 transform hover:-translate-y-1 flex flex-col justify-between';
            
            // Formatage des t√©l√©chargements (ex: 55M, 400K)
            const downloadsFormatted = new Intl.NumberFormat('fr-FR', { notation: 'compact', maximumFractionDigits: 1 }).format(resource.downloads);

            card.innerHTML = `
                <div>
                    <div class="flex items-start space-x-4 mb-4">
                        <span class="text-4xl leading-none flex-shrink-0">${resource.icon}</span>
                        <div>
                            <h3 class="text-xl font-bold text-white">${resource.title}</h3>
                            <p class="text-sm text-yellow-400">${resource.project_type === 'mod' ? 'Mod' : 'Plugin'}</p>
                        </div>
                    </div>
                    <p class="text-gray-300 mb-4 text-sm">${resource.description}</p>
                </div>
                
                <div class="pt-4 border-t border-gray-700 mt-4">
                    <div class="grid grid-cols-2 gap-2 text-xs font-semibold mb-3">
                        <div class="flex items-center space-x-2 text-gray-400">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            <span>${downloadsFormatted} T√©l.</span>
                        </div>
                        <div class="flex items-center space-x-2 text-gray-400">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414l-2.438-2.438m0 0L17 5m-2.586 2.586l2.438 2.438"></path></svg>
                            <span>v${resource.version}</span>
                        </div>
                    </div>
                    <a href="${getModrinthUrl(resource.slug)}" target="_blank" rel="noopener noreferrer"
                       class="w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-gray-900 bg-yellow-500 hover:bg-yellow-400 transition duration-150">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        T√©l√©charger (Modrinth)
                    </a>
                </div>
            `;
            return card;
        }

        // Fonction principale pour charger et afficher les ressources
        async function loadResources(projectType) {
            const container = document.getElementById('resources-container');
            const searchInput = document.getElementById('search-input').value;
            const versionFilter = document.getElementById('version-filter').value;
            const noResults = document.getElementById('no-results');
            
            container.innerHTML = '';
            noResults.classList.add('hidden');

            try {
                // Appel √† la fonction qui simule la requ√™te API
                const resources = await fetchSimulatedData(searchInput, projectType, versionFilter);

                if (resources.length === 0) {
                    noResults.classList.remove('hidden');
                } else {
                    resources.forEach(resource => {
                        container.appendChild(createResourceCard(resource));
                    });
                }
            } catch (error) {
                console.error("Erreur lors du chargement des ressources (simul√©):", error);
                document.getElementById('loading-indicator').classList.add('hidden');
                noResults.classList.remove('hidden');
                document.getElementById('no-results').innerHTML = `<p class="text-xl font-semibold mt-4 text-red-400">Erreur de chargement des donn√©es.</p><p class="text-gray-400">Veuillez r√©essayer plus tard.</p>`;
            }
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            // Commencez par l'onglet 'mod' (Mods) actif
            setActiveTab('mod'); 
        });
    </script>
    
    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-700/50 py-8 mt-12">
        <div class="container mx-auto px-4 text-center text-gray-500">
            <p>&copy; 2025 CraftKit. Tous droits r√©serv√©s. | <a href="legal.html" class="hover:text-yellow-400">Mentions L√©gales</a></p>
        </div>
    </footer>

</body>
</html>

